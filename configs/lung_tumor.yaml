# Lung Tumor Segmentation Configuration
# ======================================

# Model Configuration
model:
  n_channels: 1          # Grayscale CT images
  n_classes: 2           # Background + Tumor
  bilinear: true         # Use bilinear upsampling (vs transposed conv)
  base_features: 64      # Base number of features

# Data Configuration
data:
  root: ./lung_tumor_segmentation
  img_size: 256
  val_ratio: 0.2         # 20% for validation
  batch_size: 8
  num_workers: 4

# Training Configuration
train:
  epochs: 100
  lr: 0.001              # Initial learning rate
  weight_decay: 0.0001   # L2 regularization
  grad_clip: 1.0         # Gradient clipping (0 to disable)

# Learning Rate Scheduler
scheduler:
  type: reduce_on_plateau  # Options: reduce_on_plateau, cosine, step
  patience: 10             # For reduce_on_plateau
  factor: 0.5              # LR reduction factor
  min_lr: 0.000001         # Minimum learning rate

# Early Stopping
early_stopping:
  enabled: true
  patience: 20           # Epochs to wait before stopping
  monitor: mean_dice     # Metric to monitor
  mode: max              # 'max' for metrics, 'min' for loss

# Loss Function
loss:
  type: focal_tversky    # Best for small objects (tumors)
  # Focal Tversky penalizes false negatives more heavily (alpha > beta)
  # This helps detect small tumors that might otherwise be missed
  tversky_alpha: 0.7     # Weight for false negatives (higher = penalize missed tumors more)
  tversky_beta: 0.3      # Weight for false positives
  focal_gamma: 0.75      # Focus on hard examples

# Data Augmentation
augmentation:
  enabled: true
  horizontal_flip: 0.5   # Probability
  rotation_limit: 15     # Max rotation angle
  elastic: 0.3           # Elastic deformation probability
  brightness_contrast: 0.3

# Output Configuration
output:
  save_dir: ./runs
  experiment_name: lung_tumor
  save_last: true        # Save last checkpoint
  save_best: true        # Save best checkpoint

# Reproducibility
seed: 42

# Device
device: ""               # Empty for auto-detect (cuda > mps > cpu)
